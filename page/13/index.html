<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=5" name="viewport"><meta content="yes" name="mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><title>hsfzxjy 的博客</title><meta itemprop="title" content="hsfzxjy 的博客"><meta itemprop="og:title" content="hsfzxjy 的博客"><meta itemprop="image" content="https://i.hsfzxjy.site/avatar-for-hsfzxjy.jpg"><meta itemprop="og:image" content="https://i.hsfzxjy.site/avatar-for-hsfzxjy.jpg"><meta itemprop="og:type" content="website"><link rel="stylesheet" href="/dist/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/rss+xml" href="/rss.xml"></head><body><nav class="nav"><span class="nav__toggler"><span class="nav__toggler-bar bar1"></span><span class="nav__toggler-bar bar2"></span><span class="nav__toggler-bar bar3"></span></span><span class="nav__core"><div class="nav__logo"><img src="/avatar.webp" loading="lazy"></div><a href="/" lang="zh" class="nav__brand">hsfzxjy</a></span><span class="nav__togglerClose"><span class="nav__togglerClose-circle"></span><span class="nav__togglerClose-bar bar1"></span><span class="nav__togglerClose-bar bar2"></span></span><div class="nav__pathIndicator"><a href="/">Home</a></div></nav><main class="mainContainer"><div class="post-list"><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva1647-computer-transformation/">UVa1647 Computer Transformation</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-24 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="bb406577af369533a757b2573c301137b4959ee2a795445f66da149cdffcda04" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=825&page=show_problem&problem=4522">Link</a> 耗时：0.679s</p></blockquote><h2 id="分析-3">分析</h2><p>本质上，这是一道求数列通项的题目。我们列出前几个字符串： $$01,$$ $$1001,$$ $$01101001,$$ $$1001011001101001,$$ $$\ldots$$</p><p class="par">如果用$S_i$表示第 i 个字符串中“00”的个数，则有： $$S_1=0,\ S_2=1,\ S_3=1,\ S_4=3,\ S_5=5,\ S_6=11,\ldots$$</p><p class="par">经过观察可以发现有如下规律： $$S_n=2\times S_{n-1}+{(-1)}^n$$</p><p class="par">求通项就简单了，换个元即可： $$S_n=\frac{1}{3}[{(-1)}^n+2^{n-1}]$$</p><p>程序采用高精度实现。</p><h2 id="code-6">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">const</span></span><br><span class="line">    JINDU = <span class="hljs-number">100000</span>;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    n: Integer;</span><br><span class="line"><span class="hljs-comment">//在数字前补0</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">PrintANumber</span><span class="hljs-params">(x: longint)</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    t: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> x = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;00000&#x27;</span>)</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        t := JINDU;</span><br><span class="line">        <span class="hljs-keyword">while</span> t &gt; x * <span class="hljs-number">10</span> <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            <span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>);</span><br><span class="line">            t := t <span class="hljs-keyword">div</span> <span class="hljs-number">10</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">write</span>(x);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    ans: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">300</span>] <span class="hljs-keyword">of</span> longint;</span><br><span class="line">    len, i: integer;</span><br><span class="line"><span class="hljs-comment">//计算2^(n-1)</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">calc2</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i, x, t, mul: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    len := <span class="hljs-number">1</span>;</span><br><span class="line">    ans[<span class="hljs-number">1</span>] := <span class="hljs-number">1</span>;</span><br><span class="line">    t := n-<span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> t &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">if</span> t &lt; <span class="hljs-number">6</span> <span class="hljs-keyword">then</span></span><br><span class="line">            mul := <span class="hljs-number">1</span> &lt;&lt; t</span><br><span class="line">        <span class="hljs-keyword">else</span></span><br><span class="line">            mul := <span class="hljs-number">64</span>;</span><br><span class="line">        x := <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> len <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            ans[i] := ans[i] * mul + x;</span><br><span class="line">            x := ans[i] <span class="hljs-keyword">div</span> JINDU;</span><br><span class="line">            ans[i] := ans[i] <span class="hljs-keyword">mod</span> JINDU;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            inc(len);</span><br><span class="line">            ans[len] := x;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        dec(t, <span class="hljs-number">6</span>);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-comment">//除以3</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">div3</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i, x, t: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    i := len;</span><br><span class="line">    x := <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> i &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        t := (x * JINDU + ans[i]);</span><br><span class="line">        ans[i] := t <span class="hljs-keyword">div</span> <span class="hljs-number">3</span>;</span><br><span class="line">        x := t <span class="hljs-keyword">mod</span> <span class="hljs-number">3</span>;</span><br><span class="line">        dec(i);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> ans[len] = <span class="hljs-number">0</span> <span class="hljs-keyword">do</span> dec(len);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> eof <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        readln(n);</span><br><span class="line">        <span class="hljs-keyword">if</span> n=<span class="hljs-number">1</span> <span class="hljs-keyword">then</span>   <span class="hljs-comment">//特殊情况处理</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            writeln(<span class="hljs-number">0</span>);</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        fillchar(ans, sizeof(ans), <span class="hljs-number">0</span>);</span><br><span class="line">        calc2;</span><br><span class="line">        <span class="hljs-keyword">if</span> odd(n) <span class="hljs-keyword">then</span></span><br><span class="line">            dec(ans[<span class="hljs-number">1</span>])</span><br><span class="line">        <span class="hljs-keyword">else</span></span><br><span class="line">            inc(ans[<span class="hljs-number">1</span>]);</span><br><span class="line">        div3;</span><br><span class="line">        <span class="hljs-keyword">write</span>(ans[len]);</span><br><span class="line">        <span class="hljs-keyword">for</span> i := len-<span class="hljs-number">1</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">1</span> <span class="hljs-keyword">do</span></span><br><span class="line">            PrintANumber(ans[i]);</span><br><span class="line">        writeln;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    close(input); close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva1647-computer-transformation/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/sublime-configuration-for-pascal/">Sublime configuration for Pascal</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-23 | <span class="post__meta-categories"><a href="/categories/Memo/">Memo</a></span></div><div data-post-id="226b50d3ed3c4547d6f2d057b017c64cff3266671c5e6fb0450dbf691292b10f" class="post__content font__body"><p class="noindent">鉴于 U 盘中 Sublime 的配置常常莫名其妙地消失，在此将其记录一下。</p><h2 id="code-7">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-punctuation">{</span></span><br><span class="line">    <span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;fpc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;-S2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;${file}&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;-o${file_path}/${file_base_name}.exe&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></span><br><span class="line">    <span class="hljs-attr">&quot;file_regex&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="line">    <span class="hljs-attr">&quot;working_dir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;${file_path}&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="line">    <span class="hljs-attr">&quot;selector&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;source.pascal&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-attr">&quot;variants&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></span><br><span class="line">        <span class="hljs-punctuation">{</span></span><br><span class="line">            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Run&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="line">            <span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;cmd&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/c&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;fpc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;-S2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;${file}&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;-o${file_path}/${file_base_name}.exe&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="line">    <span class="hljs-string">&quot;&amp;&amp;&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;${file_path}/${file_base_name}.exe&quot;</span><span class="hljs-punctuation">]</span></span><br><span class="line">        <span class="hljs-punctuation">}</span></span><br><span class="line">    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-attr">&quot;osx&quot;</span><span class="hljs-punctuation">:</span></span><br><span class="line">    <span class="hljs-punctuation">{</span></span><br><span class="line">        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/usr/local/bin:/usr/bin:/bin:${path}&quot;</span></span><br><span class="line">    <span class="hljs-punctuation">}</span></span><br><span class="line"><span class="hljs-punctuation">}</span></span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/sublime-configuration-for-pascal/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva11526-hn/">UVa11526 H(n)</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-18 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="41f7d39b33afbfbabbe55673f456c38c58f441ef433cb2b3d9b5411ac4a3a034" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=27&problem=2521&mosmsg=Submission%20received%20with%20ID%2014374168">Link</a> 耗时：2.232s</p></blockquote><h2 id="分析-2">分析</h2><p>粗看题目，不过就是要求这样一个式子：$\sum_{i=1}^n{[\frac{n}{i}]}$的值。但<strong>注意到</strong>：题目给的数据范围极大，有$2^{31}-1$之多，若遍历计算，则时间复杂度为$O(n)$，将严重超时，不可取。</p><p class="nomargin">而事实上，通过尝试我们可以发现：$\sum_{i=1}^{n}{[\frac{n}{i}]}=2*\sum_{i=1}^{\sqrt n}{[\frac{n}{i}]}-{[\sqrt n]}^2$，这是一个重要的结论。因为这条式子一旦成立，时间复杂度即可从$O(n)$降为$O(\sqrt n)$，这是一个极为可观的改善。下面我们来证明一下这个结论：</p><p class="nomargin">事实上，</p><p>$$ \begin{aligned} \sum_{i=[{\sqrt n}]+1}^{n}{[\frac{n}{i}]} &amp;=1\times(n-[\frac{n}{2}])+2\times([\frac{n}{2}]-[\frac{n}{3}])+\ldots+[\sqrt{n}]\times([\frac{n}{\sqrt{n}}]-{[\frac{n}{\sqrt n}+1]}) \\ &amp;=n+[\frac{n}{2}]+[\frac{n}{3}]+\ldots+[\frac{n}{\sqrt n}]-[\sqrt n]\times[\frac{n}{[\sqrt n]+1}] \\ &amp;=\sum_{i=1}^{[\sqrt n]}{[\frac{n}{i}]}-{[\sqrt n]}^2 \end{aligned}$$</p><p class="par">从而，命题得证。</p><h2 id="code-5">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    n, _, i: longint;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>:</span> int64; <span class="hljs-keyword">inline</span>;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    k, t: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    h := <span class="hljs-number">0</span>;</span><br><span class="line">    t := trunc(sqrt(n));</span><br><span class="line">    k := <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> k &lt;=t <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        h := h + n <span class="hljs-keyword">div</span> k;</span><br><span class="line">        inc(k);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    h := h * <span class="hljs-number">2</span> - t * t;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line"></span><br><span class="line">    readln(_);</span><br><span class="line">    <span class="hljs-keyword">while</span> _ &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        dec(_);</span><br><span class="line">        readln(n);</span><br><span class="line">        <span class="hljs-keyword">if</span> n &lt;= <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">            writeln(<span class="hljs-number">0</span>)</span><br><span class="line">        <span class="hljs-keyword">else</span></span><br><span class="line">            writeln(h);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    close(input);</span><br><span class="line">    close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva11526-hn/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva817-according-to-bartjens/">UVa817 According to Bartjens</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-17 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="f1a7a04d76582c3d820b0b634ae1b9da2f962a92295ea7132440661933319a05" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=10&problem=758&mosmsg=Submission%20received%20with%20ID%2014367065">Link</a> 状态：<strong>WA</strong></p></blockquote><h2 id="分析-1">分析</h2><p>做了两个小时，很可惜最终还是 WA 了。非常奇怪——和网上的 C++ 代码运行结果完全一样，但却 WA 了。不过，在这里我还是记录一下解题的过程。 这道题数据量很小，直接爆搜每个空位，用 <code>*</code>, <code>+</code>, <code>-</code>, <code>#0</code> 来代表符号或不填。</p><h2 id="code-4">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">const</span></span><br><span class="line">    operators: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">4</span>] <span class="hljs-keyword">of</span> char = (<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">#0</span>); <span class="hljs-comment">//符号</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    s: <span class="hljs-keyword">string</span>;</span><br><span class="line">    _, n: integer;</span><br><span class="line">    op: <span class="hljs-keyword">array</span> [<span class="hljs-number">0</span>..<span class="hljs-number">10</span>] <span class="hljs-keyword">of</span> char;</span><br><span class="line">    yes: Boolean;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toValue</span><span class="hljs-params">(ch: char)</span>:</span> integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">exit</span>(ord(ch) - ord(<span class="hljs-string">&#x27;0&#x27;</span>));</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">calcAndPrint</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    numtop, opstop: Integer;  <span class="hljs-comment">//数字栈，符号栈</span></span><br><span class="line">    num: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">10</span>] <span class="hljs-keyword">of</span> longint;</span><br><span class="line">    ops: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">10</span>] <span class="hljs-keyword">of</span> char;</span><br><span class="line">    i: integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    i := <span class="hljs-number">1</span>;</span><br><span class="line">    numtop := <span class="hljs-number">1</span>;</span><br><span class="line">    num[numtop] := toValue(s[<span class="hljs-number">1</span>]);</span><br><span class="line">    opstop := <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> i &lt;= n <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">while</span> (i &lt; n) <span class="hljs-keyword">and</span> (op[i] = <span class="hljs-string">#0</span>) <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            inc(i);</span><br><span class="line">            num[numtop] := num[numtop] * <span class="hljs-number">10</span> + toValue(s[i]);</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> (op[i] <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>]) <span class="hljs-keyword">or</span> (i &gt;= n) <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            <span class="hljs-keyword">while</span> (opstop &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> (ops[opstop] = <span class="hljs-string">&#x27;*&#x27;</span>) <span class="hljs-keyword">do</span></span><br><span class="line">            <span class="hljs-keyword">begin</span></span><br><span class="line">                dec(opstop);</span><br><span class="line">                num[numtop - <span class="hljs-number">1</span>] := num[numtop] * num[numtop -<span class="hljs-number">1</span>];</span><br><span class="line">                dec(numtop);</span><br><span class="line">            <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> i &gt;= n <span class="hljs-keyword">then</span> <span class="hljs-keyword">break</span>;</span><br><span class="line">        inc(opstop);</span><br><span class="line">        ops[opstop] := op[i];</span><br><span class="line">        inc(i);</span><br><span class="line">        inc(numtop);</span><br><span class="line">        num[numtop] := toValue(s[i]);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    i := <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> i &lt; numtop <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">if</span> ops[i] = <span class="hljs-string">&#x27;+&#x27;</span> <span class="hljs-keyword">then</span></span><br><span class="line">            num[i+<span class="hljs-number">1</span>] := num[i] + num[i+<span class="hljs-number">1</span>]</span><br><span class="line">        <span class="hljs-keyword">else</span></span><br><span class="line">            num[i+<span class="hljs-number">1</span>] := num[i] - num[i+<span class="hljs-number">1</span>];</span><br><span class="line">        inc(i);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (num[numtop] = <span class="hljs-number">2000</span>) <span class="hljs-keyword">and</span> (opstop &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        yes := True;</span><br><span class="line">        <span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;  &#x27;</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> n <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            <span class="hljs-keyword">write</span>(s[i]);</span><br><span class="line">            <span class="hljs-keyword">if</span> op[i] &lt;&gt; <span class="hljs-string">#0</span>  <span class="hljs-keyword">then</span></span><br><span class="line">                <span class="hljs-keyword">write</span>(op[i]);</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        writeln(<span class="hljs-string">&#x27;=&#x27;</span>);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">dfs</span><span class="hljs-params">(t: integer)</span>;</span> <span class="hljs-comment">//搜索第t个位置</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i: Integer;</span><br><span class="line">    ch: char;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> t = n <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        calcAndPrint;</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> <span class="hljs-number">4</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        ch := operators[i];</span><br><span class="line">        <span class="hljs-keyword">if</span> (ch = <span class="hljs-string">#0</span>) <span class="hljs-keyword">and</span> (s[t] = <span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-keyword">and</span> ((t = <span class="hljs-number">1</span>) <span class="hljs-keyword">or</span> (t &gt; <span class="hljs-number">1</span>) <span class="hljs-keyword">and</span> (op[t-<span class="hljs-number">1</span>] &lt;&gt; <span class="hljs-string">#0</span>)) <span class="hljs-keyword">then</span> <span class="hljs-keyword">continue</span>;</span><br><span class="line">        op[t] := ch;</span><br><span class="line">        dfs(t+<span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i: Integer;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line"></span><br><span class="line">    readln(s);</span><br><span class="line">    _ := <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> eof <span class="hljs-keyword">and</span> (s[<span class="hljs-number">1</span>] &lt;&gt; <span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        i := <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> (s[i] <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;0&#x27;</span>..<span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;=&#x27;</span>]) <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            inc(i);</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        delete(s, <span class="hljs-number">1</span>, i-<span class="hljs-number">1</span>);</span><br><span class="line">        n := pos(<span class="hljs-string">&#x27;=&#x27;</span>, s) - <span class="hljs-number">1</span>;</span><br><span class="line">        inc(_);</span><br><span class="line">        writeln(<span class="hljs-string">&#x27;Problem &#x27;</span>, _);</span><br><span class="line">        yes := False;</span><br><span class="line">        fillchar(op, sizeof(op), <span class="hljs-number">0</span>);</span><br><span class="line">        dfs(<span class="hljs-number">1</span>);</span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> yes <span class="hljs-keyword">then</span></span><br><span class="line">            writeln(<span class="hljs-string">&#x27;  IMPOSSIBLE&#x27;</span>);</span><br><span class="line">        readln(s);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    close(input); close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva817-according-to-bartjens/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva225-golygons/">UVa225 Golygons</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-15 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="5389819864f99809e698813851834d508fc0ac49ae4e023f74cfafdf61d1bc16" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=4&problem=161&mosmsg=Submission%20received%20with%20ID%2014355705">Link</a> 耗时：0.699s</p></blockquote><h2 id="思路">思路</h2><p class="noindent"><code>dfs(t, x, y, d, s)</code> 表示当前走了 t 步，在 (x,y)，上一个方向为 d，s 为一个求和用的辅助变量。</p><p class="par">当前位置无法走完剩下的路时直接回溯。可节省接近 2s 的时间。</p><p class="noindent"><strong>p.s.</strong> 这道题虽然没有明说每个城市只走一次，但它的确那样判了，这一点坑了我好久。</p><h2 id="code-3">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-comment">//Accepted.</span></span><br><span class="line"><span class="hljs-keyword">const</span></span><br><span class="line">    dx: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">4</span>] <span class="hljs-keyword">of</span> integer = (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);</span><br><span class="line">    dy: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">4</span>] <span class="hljs-keyword">of</span> integer = (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);</span><br><span class="line">    dir: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">4</span>] <span class="hljs-keyword">of</span> char = (<span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    a: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">50</span>, <span class="hljs-number">1</span>..<span class="hljs-number">2</span>] <span class="hljs-keyword">of</span> integer; <span class="hljs-comment">//障碍物</span></span><br><span class="line">    k, i, n, _, x, y: integer;</span><br><span class="line">    ans: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">20</span>] <span class="hljs-keyword">of</span> char;</span><br><span class="line">    tot: longint;</span><br><span class="line">    vis: <span class="hljs-keyword">array</span> [-<span class="hljs-number">220</span>..<span class="hljs-number">220</span>, -<span class="hljs-number">220</span>..<span class="hljs-number">220</span>] <span class="hljs-keyword">of</span> boolean;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">judge</span><span class="hljs-params">(x1, y1, x2, y2: longint)</span>:</span> Boolean; <span class="hljs-comment">//判断刚刚走过的路上是否有障碍物</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i: Integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    judge := False;</span><br><span class="line">    <span class="hljs-keyword">if</span> x1 = x2 <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> k <span class="hljs-keyword">do</span></span><br><span class="line">            <span class="hljs-keyword">if</span> (a[i, <span class="hljs-number">1</span>] = x1) <span class="hljs-keyword">and</span> ((a[i, <span class="hljs-number">2</span>] - y1)*(a[i, <span class="hljs-number">2</span>] - y2) &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>;</span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> k <span class="hljs-keyword">do</span></span><br><span class="line">            <span class="hljs-keyword">if</span> (a[i, <span class="hljs-number">2</span>] = y2) <span class="hljs-keyword">and</span> ((a[i, <span class="hljs-number">1</span>] - x1)*(a[i, <span class="hljs-number">1</span>] - x2) &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>;</span><br><span class="line">    judge := True;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">print</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i: Integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> n <span class="hljs-keyword">do</span> <span class="hljs-keyword">write</span>(ans[i]);</span><br><span class="line">    writeln;</span><br><span class="line">    inc(tot);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">dfs</span><span class="hljs-params">(t, x, y, d, s: integer)</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i, sum: Integer;</span><br><span class="line">    tx, ty: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> t = n <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">if</span> (x = <span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> (y = <span class="hljs-number">0</span>) <span class="hljs-keyword">then</span> print;</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    sum := s - t - <span class="hljs-number">1</span>;</span><br><span class="line">    inc(t);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> <span class="hljs-number">4</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">if</span> (i = d) <span class="hljs-keyword">or</span> (i + d = <span class="hljs-number">5</span>) <span class="hljs-keyword">then</span> <span class="hljs-keyword">continue</span>;   <span class="hljs-comment">//方向相同或相反</span></span><br><span class="line">        tx := x + dx[i] * t;</span><br><span class="line">        ty := y + dy[i] * t;</span><br><span class="line">        <span class="hljs-keyword">if</span> vis[tx, ty] <span class="hljs-keyword">then</span> <span class="hljs-keyword">continue</span>;              <span class="hljs-comment">//走过</span></span><br><span class="line">        <span class="hljs-keyword">if</span> abs(tx) + abs(ty) &gt; sum <span class="hljs-keyword">then</span> <span class="hljs-keyword">continue</span>;  <span class="hljs-comment">//回不去，剪枝</span></span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> judge(x, y, tx, ty) <span class="hljs-keyword">then</span> <span class="hljs-keyword">continue</span>;  <span class="hljs-comment">//有障碍物</span></span><br><span class="line">        ans[t] := dir[i];</span><br><span class="line">        vis[tx, ty] := True;</span><br><span class="line">        dfs(t, tx, ty, i, sum);</span><br><span class="line">        vis[tx, ty] := False;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line"></span><br><span class="line">    readln(_);</span><br><span class="line">    <span class="hljs-keyword">while</span> _ &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        dec(_);</span><br><span class="line">        <span class="hljs-keyword">read</span>(n, k);</span><br><span class="line">        fillchar(vis, sizeof(vis), <span class="hljs-number">0</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> k <span class="hljs-keyword">do</span></span><br><span class="line">            <span class="hljs-keyword">read</span>(a[i, <span class="hljs-number">1</span>], a[i, <span class="hljs-number">2</span>]);</span><br><span class="line">        fillchar(ans, sizeof(ans), <span class="hljs-number">0</span>);</span><br><span class="line">        tot := <span class="hljs-number">0</span>;</span><br><span class="line">        dfs(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, n * (n+<span class="hljs-number">1</span>) <span class="hljs-keyword">div</span> <span class="hljs-number">2</span>);</span><br><span class="line">        writeln(<span class="hljs-string">&#x27;Found &#x27;</span>, tot, <span class="hljs-string">&#x27; golygon(s).&#x27;</span>);</span><br><span class="line">        writeln;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    close(input); close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva225-golygons/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva12219-common-subexpression-elimination/">UVa12219 Common Subexpression Elimination</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-05 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="de3ff9b8e5b98f19753b61bb1e206e9089533772b9ea4f511b9025f865266391" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=3371">Link</a> 状态：<strong>Runtime Error</strong></p></blockquote><h2 id="前言-2">前言</h2><p>这题做的可真够久的，整整三个小时。但即便如此，还是只过了一部分的点，另一部分报运行时错误——估计是哈希表设计的不太好。但这确实是一道好题，因此，在睡觉前决定记录一下。</p><h2 id="分析">分析</h2><p>很容易便想到：用一个三元组 $(x,y,z)$ 表示节点，表示内容为 x 的节点下跟着标号为 y 和 z 的左右子树。这样一来，一类相同的子树便可以唯一确定了，而不必每构造一棵子树就把整棵树遍历一遍。 对于三元组的储存，刚开始图方便，用了数组。查找也是用了 $O(n)$ 的线性查找。磕磕碰碰写了两个多小时然后兴冲冲地提交，结果 TLE 了…………没办法，只好又花了半个小时写了一个哈希表，然后就是上文说过的情况了：<strong>Runtime Error204</strong>。可能是哈希数组过大的原因，日后再微调一下，今天实在是没有脑子了。</p><h2 id="code-2">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">const</span></span><br><span class="line">  maxn = <span class="hljs-number">20000</span>;</span><br><span class="line"><span class="hljs-keyword">type</span></span><br><span class="line">  NodeRec = <span class="hljs-keyword">record</span></span><br><span class="line">    Value: <span class="hljs-keyword">string</span>;</span><br><span class="line">    l, r, <span class="hljs-keyword">index</span>: longint;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  Node = <span class="hljs-keyword">record</span></span><br><span class="line">      left, right: longint;   <span class="hljs-comment">//Index of left and right child in the `tree` array, -1 for none.</span></span><br><span class="line">      Rec: NodeRec;</span><br><span class="line">      <span class="hljs-keyword">index</span>: longint;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  <span class="hljs-comment">//以下为哈希表的定义</span></span><br><span class="line">  _PNode = ^_Node;</span><br><span class="line">  _Node = <span class="hljs-keyword">record</span></span><br><span class="line">    n: Node;</span><br><span class="line">    next: _PNode;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line">  HashTable = <span class="hljs-keyword">object</span></span><br><span class="line">    arr: <span class="hljs-keyword">array</span> [<span class="hljs-number">0</span>..maxn] <span class="hljs-keyword">of</span> _PNode;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hash</span><span class="hljs-params">(n: NodeRec)</span>:</span> longint;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">add</span><span class="hljs-params">(n: Node)</span>;</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">clear</span>;</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span><span class="hljs-params">(n: NodeRec)</span>:</span> longint;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">HashTable</span>.<span class="hljs-title">clear</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  i: longint;</span><br><span class="line">  p, q: _PNode;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span> <span class="hljs-keyword">to</span> maxn <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    p := arr[i];</span><br><span class="line">    <span class="hljs-keyword">while</span> p&lt;&gt;<span class="hljs-keyword">nil</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">      q := p^.next;</span><br><span class="line">      dispose(p);</span><br><span class="line">      p := q;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  fillchar(arr, sizeof(arr),<span class="hljs-number">0</span>);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cmp</span><span class="hljs-params">(r1, r2: NodeRec)</span>:</span> Boolean;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  cmp := (r1.l = r2.l) <span class="hljs-keyword">and</span> (r1.r = r2.r) <span class="hljs-keyword">and</span> (r1.Value = r2.Value);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HashTable</span>.<span class="hljs-title">hash</span><span class="hljs-params">(n: NodeRec)</span>:</span> longint;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  i: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  hash := <span class="hljs-number">0</span>;</span><br><span class="line">  <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> length(n.Value) <span class="hljs-keyword">do</span></span><br><span class="line">    hash := (hash*<span class="hljs-number">5</span> + ord(n.Value[i]) - ord(<span class="hljs-string">&#x27;a&#x27;</span>)) <span class="hljs-keyword">mod</span> maxn;</span><br><span class="line">  hash := (hash + n.l * <span class="hljs-number">10</span> + n.r * <span class="hljs-number">5</span>) <span class="hljs-keyword">mod</span> maxn;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">HashTable</span>.<span class="hljs-title">add</span><span class="hljs-params">(n: Node)</span>;</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  h: longint;</span><br><span class="line">  p, q: _PNode;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  h := hash(n.rec);</span><br><span class="line">  new(q);</span><br><span class="line">  fillchar(q^, sizeof(_Node), <span class="hljs-number">0</span>);</span><br><span class="line">  q^.next := arr[h];</span><br><span class="line">  q^.n := n;</span><br><span class="line">  arr[h] := q;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HashTable</span>.<span class="hljs-title">find</span><span class="hljs-params">(n: NodeRec)</span>:</span> longint;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  p: _PNode;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  find := -<span class="hljs-number">1</span>;</span><br><span class="line">  p := arr[hash(n)];</span><br><span class="line">  <span class="hljs-keyword">while</span> (p&lt;&gt;<span class="hljs-keyword">nil</span>) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> cmp(n, p^.n.rec) <span class="hljs-keyword">do</span> p := p^.next;</span><br><span class="line">  <span class="hljs-keyword">if</span> p &lt;&gt; <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span></span><br><span class="line">    find := p^.n.<span class="hljs-keyword">index</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-comment">//哈系表定义结束</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  inputs: Ansistring;</span><br><span class="line">  _: longint;</span><br><span class="line">  tree: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">50001</span>] <span class="hljs-keyword">of</span> Node;</span><br><span class="line">  cur: longint;              <span class="hljs-comment">//The current pointer of the input string.</span></span><br><span class="line">  num: longint;              <span class="hljs-comment">//The current number of the `tree` array.</span></span><br><span class="line">  ls: longint;</span><br><span class="line">  t: longint;</span><br><span class="line">  tot: longint;</span><br><span class="line">  ht: HashTable;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build</span>:</span> longint; <span class="hljs-comment">//建树</span></span><br><span class="line"><span class="hljs-keyword">label</span> lb;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">  rec: NodeRec;</span><br><span class="line">  i,j,l,r: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  l := <span class="hljs-number">0</span>;</span><br><span class="line">  r := <span class="hljs-number">0</span>;</span><br><span class="line">  fillchar(rec, sizeof(rec), <span class="hljs-number">0</span>);</span><br><span class="line">  inc(tot);</span><br><span class="line">  rec.<span class="hljs-keyword">index</span> := tot;</span><br><span class="line">  <span class="hljs-keyword">while</span> (cur&lt;=ls) <span class="hljs-keyword">and</span> (inputs[cur] <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;a&#x27;</span>..<span class="hljs-string">&#x27;z&#x27;</span>]) <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    rec.Value := rec.Value+inputs[cur];</span><br><span class="line">    inc(cur);</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  <span class="hljs-keyword">if</span> cur&gt;ls <span class="hljs-keyword">then</span> <span class="hljs-keyword">goto</span> lb;    <span class="hljs-comment">//。。。这里被迫跳转控制流，由于实在不想多谢，就用了臭名昭著的label</span></span><br><span class="line">  <span class="hljs-keyword">if</span> inputs[cur] = <span class="hljs-string">&#x27;(&#x27;</span> <span class="hljs-keyword">then</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    inc(cur);</span><br><span class="line">    l := build();</span><br><span class="line">    rec.l := tree[l].rec.<span class="hljs-keyword">index</span>;</span><br><span class="line">    inc(cur);</span><br><span class="line">    r := build();</span><br><span class="line">    rec.r := tree[r].rec.<span class="hljs-keyword">index</span>;</span><br><span class="line">    inc(cur);</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  j := ht.find(rec);</span><br><span class="line">  <span class="hljs-keyword">if</span> j&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    dec(tot);</span><br><span class="line">    <span class="hljs-keyword">exit</span>(j);</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line">  <span class="hljs-keyword">else</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">lb:</span><br><span class="line">    inc(num);</span><br><span class="line">    tree[num].left := l;</span><br><span class="line">    tree[num].right := r;</span><br><span class="line">    tree[num].rec := rec;</span><br><span class="line">    tree[num].<span class="hljs-keyword">index</span> := num;</span><br><span class="line">    ht.add(tree[num]);</span><br><span class="line">    <span class="hljs-keyword">exit</span>(num);</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">print</span><span class="hljs-params">(n: longint)</span>;</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  <span class="hljs-keyword">if</span> tree[n].rec.<span class="hljs-keyword">index</span> &gt; t <span class="hljs-keyword">then</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">write</span>(tree[n].rec.Value);</span><br><span class="line">    t := tree[n].rec.<span class="hljs-keyword">index</span>;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line">  <span class="hljs-keyword">else</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">write</span>(tree[n].rec.<span class="hljs-keyword">index</span>);</span><br><span class="line">    <span class="hljs-keyword">exit</span>;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  <span class="hljs-keyword">if</span> tree[n].right = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">exit</span>;</span><br><span class="line">  <span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;(&#x27;</span>);</span><br><span class="line">  print(tree[n].left);</span><br><span class="line">  <span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;,&#x27;</span>);</span><br><span class="line">  print(tree[n].right);</span><br><span class="line">  <span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;)&#x27;</span>);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">  assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">  assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line">  readln(_);</span><br><span class="line">  fillchar(ht.arr, sizeof(ht.arr),<span class="hljs-number">0</span>);</span><br><span class="line">  <span class="hljs-keyword">while</span> _&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">begin</span></span><br><span class="line">    dec(_);</span><br><span class="line">    readln(inputs);</span><br><span class="line">    fillchar(tree, sizeof(tree), <span class="hljs-number">0</span>);</span><br><span class="line">    ht.clear;</span><br><span class="line">    ls := length(inputs);</span><br><span class="line">    cur := <span class="hljs-number">1</span>;  num := <span class="hljs-number">0</span>; tot := <span class="hljs-number">0</span>;</span><br><span class="line">    build;</span><br><span class="line">    t := <span class="hljs-number">0</span>;</span><br><span class="line">    print(num);</span><br><span class="line">    writeln;</span><br><span class="line">  <span class="hljs-keyword">end</span>;</span><br><span class="line">  close(input); close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva12219-common-subexpression-elimination/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva536-recovery/">UVa536 Recovery</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-05 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="d810681cda91d4f8b83c1d414995abe9a226f4b7488e599161f7440e86b9db53" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=7&page=show_problem&problem=477">Link</a> 耗时：0.012s</p></blockquote><h2 id="前言-1">前言</h2><p>真是疯玩了几天，脑袋都残了，一道弱智题做了近一个小时。</p><h2 id="code-1">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    pre, mid, s: <span class="hljs-keyword">string</span>;</span><br><span class="line">    tree: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">50</span>] <span class="hljs-keyword">of</span> <span class="hljs-keyword">record</span></span><br><span class="line">        l, r: integer;</span><br><span class="line">        ch: char;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    cur: integer;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>:</span> integer;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    m: integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    readln(s);</span><br><span class="line">    m := length(s) &gt;&gt; <span class="hljs-number">1</span> + <span class="hljs-number">1</span>;</span><br><span class="line">    pre := Copy(s, <span class="hljs-number">1</span>, m-<span class="hljs-number">1</span>);</span><br><span class="line">    mid := Copy(s, m+<span class="hljs-number">1</span>, length(s));</span><br><span class="line">    init := m-<span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build</span><span class="hljs-params">(l1, l2, r2: integer)</span>:</span> integer;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    m,len: integer;</span><br><span class="line">    t: integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> l2 &gt; r2 <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">//该子树不存在。**这个地方坑了我很久**</span></span><br><span class="line">    inc(cur);</span><br><span class="line">    t := cur;      <span class="hljs-comment">// 这里也坑了我，当下面构造完左右子树后，cur已经变了，所以要缓存起来</span></span><br><span class="line">    build := t;</span><br><span class="line">    tree[t].ch := pre[l1];</span><br><span class="line">    <span class="hljs-keyword">if</span> r2-l2 = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-comment">//叶节点</span></span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    m := pos(pre[l1], mid); <span class="hljs-comment">//在中序遍历中找根节点</span></span><br><span class="line">    len := m - l2;</span><br><span class="line">    tree[t].l := build(l1+<span class="hljs-number">1</span>, l2, m-<span class="hljs-number">1</span>); <span class="hljs-comment">//构造左子树</span></span><br><span class="line">    tree[t].r := build(l1+len+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>, r2); <span class="hljs-comment">//构造右子树</span></span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">print</span><span class="hljs-params">(x: integer)</span>;</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> x = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>;</span><br><span class="line">    print(tree[x].l);</span><br><span class="line">    print(tree[x].r);</span><br><span class="line">    <span class="hljs-keyword">write</span>(tree[x].ch);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> eof <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        fillchar(tree, sizeof(tree), <span class="hljs-number">0</span>);</span><br><span class="line">        cur := <span class="hljs-number">0</span>;</span><br><span class="line">        build(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, init);</span><br><span class="line">        print(<span class="hljs-number">1</span>);</span><br><span class="line">        writeln;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    close(input);</span><br><span class="line">    close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva536-recovery/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva11582-colossal-fibonacci-numbers/">UVa11582 Colossal Fibonacci Numbers! &amp;&amp; 大数操作</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-01 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="558ba872e084795752353e775605fbcdd375657ad3019ee92e4037d63d400200" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=27&problem=2629&mosmsg=Submission%20received%20with%20ID%2014290914">Link</a> 耗时：0.139s</p></blockquote><h2 id="前言">前言</h2><p>这道题的主要思路就是打表，看看 Fibonacci 数列模 n 几个一循环。但由于这题给的数太大了，从而在细节上耗了很久。在此记录一下：</p><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    x: qword;</span><br><span class="line">    y: longint;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    x := <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">64</span>-<span class="hljs-number">1</span>;</span><br><span class="line">    y := <span class="hljs-number">100</span>;</span><br><span class="line">    x := x <span class="hljs-keyword">mod</span> y; <span class="hljs-comment">//报错201</span></span><br><span class="line">    x := x <span class="hljs-keyword">mod</span> qword(y); <span class="hljs-comment">//正确</span></span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div><h2 id="code">Code</h2><div class="gk-code hljs" data-gk-id="BLOCK2"><div class="gk-code-display"><pre><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    a,b: qword;</span><br><span class="line">    _, n, i, k, cnt: longint;</span><br><span class="line">    f: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">1000000</span>] <span class="hljs-keyword">of</span> longint;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">superMod</span><span class="hljs-params">(a, b: qword; m: longint)</span>:</span> longint;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    x: qword;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> b = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">    x := superMod(a, b <span class="hljs-keyword">shr</span> <span class="hljs-number">1</span>, m);</span><br><span class="line">    superMod := x * x <span class="hljs-keyword">mod</span> m;</span><br><span class="line">    <span class="hljs-keyword">if</span> odd(b) <span class="hljs-keyword">then</span></span><br><span class="line">        superMod := superMod * a <span class="hljs-keyword">mod</span> m;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>); reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>); rewrite(output);</span><br><span class="line">    readln(_);</span><br><span class="line">    <span class="hljs-keyword">while</span> _ &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        dec(_);</span><br><span class="line">        readln(a, b, n);</span><br><span class="line">        <span class="hljs-keyword">if</span> a = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            writeln(<span class="hljs-number">0</span>);</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> n = <span class="hljs-number">1</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            writeln(<span class="hljs-number">0</span>);</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        f[<span class="hljs-number">1</span>] := <span class="hljs-number">1</span>;</span><br><span class="line">        f[<span class="hljs-number">2</span>] := <span class="hljs-number">1</span>;</span><br><span class="line">        cnt := <span class="hljs-number">2</span>;</span><br><span class="line">        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> ((f[cnt-<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>) <span class="hljs-keyword">and</span> (f[cnt] = <span class="hljs-number">0</span>)) <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            inc(cnt);</span><br><span class="line">            f[cnt] := (f[cnt-<span class="hljs-number">1</span>] + f[cnt-<span class="hljs-number">2</span>]) <span class="hljs-keyword">mod</span> n;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        <span class="hljs-comment">//while x &gt; int64(1 &lt;&lt;60) do</span></span><br><span class="line">        <span class="hljs-comment">//    x := x - int64((cnt &lt;&lt; 59));</span></span><br><span class="line">        a := a <span class="hljs-keyword">mod</span> qword(cnt);</span><br><span class="line">        k := superMod(a, b, cnt);</span><br><span class="line">        writeln(f[k]);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    close(output); close(input);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva11582-colossal-fibonacci-numbers/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/extended-gcd-algorithm/">扩展欧几里得算法</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-01 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="52dcf719e2703e3d48a098d0a4f146485493caacfcedfadbf20abac202929f6b" class="post__content font__body"><blockquote><p class="noindent">今天开始学习数论方面的算法。这部分在 NOIP 中并不常出现，即使出现了也不会像高联这么难（。。。）。</p></blockquote><h2 id="什么是扩展欧几里得算法">什么是扩展欧几里得算法</h2><p>所谓欧几里得算法，实际上就是辗转相除法——求两个数最大公约数的一种高效算法。而扩展欧几里得算法则是来源于于一类方程的解决：</p><p>$$ax+by=gcd(a,b)$$</p><p class="nomargin">这有点像是<strong>裴蜀定理</strong>的一般形式。和裴蜀定理类似，这类方程也有无数多个整数解。如何高效率地求得它的一组特解呢？</p><h2 id="代码">代码</h2><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">gcd_ex</span><span class="hljs-params">(a, b: longint; <span class="hljs-keyword">var</span> d: longint; <span class="hljs-keyword">var</span> x, y: longint)</span>;</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> b = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        d := a;</span><br><span class="line">        x := <span class="hljs-number">1</span>;</span><br><span class="line">        y := <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    <span class="hljs-comment">// hl:begin #1</span></span><br><span class="line">    gcd_ex(b, a <span class="hljs-keyword">mod</span> b, d, y, x);</span><br><span class="line">    <span class="hljs-comment">// hl:end</span></span><br><span class="line">    y := y-(a <span class="hljs-keyword">div</span> b) * x;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br></pre></div></div><h2 id="详解">详解</h2><p>乍一看，算法似乎和一般欧几里得算法很是相似：都是递归实现，参数传递过程中都体现了“辗转相除”的思想。那为什么这个算法是正确的呢？ 这里先解释一下参数：</p><ul><li>a：方程中的参数 a</li><li>b：方程中的参数 b</li><li>d：即 <code>gcd(a,b)</code>。由于和辗转相除法的相似性，在这里最大公约数也可以“顺便”算出。当然，去掉也无大碍</li><li>(x,y)：方程的一组特解 (x, y)</li></ul><p>下面解释标注了 <code class="_hl-label">1</code> 的那行代码。</p><p class="nomargin">假设方程 $ax+by=gcd(a,b)$ 有一组特解 $(x_0,y_0)$。则有$$ax_0+by_0=gcd(a,b)$$</p><p class="par">由最大公约数原理可知：$$gcd(a,b)=gcd(b, a\ mod\ b)$$</p><p class="par">从而有$$ax_0+by_0=gcd(b,a\ mod\ b)$$</p><p class="par">又方程 $bx+(a\ mod\ b)y=gcd(b,a\ mod\ b)$ 一定有整数解，设其为 $(x_1,y_1)$。则有</p><p>$$ax_0+by_0=gcd(b,a\ mod\ b)=bx_1+(a\ mod\ b)y_1$$即$$ax_0+by_0=bx_1+(a-(a\ div\ b)*b)y_1$$</p><p class="par">即 $$a(x_0-y_1)=b(x_1-(a\ div\ b)y_1-y_0)$$</p><p class="par">由恒等原理可知：$$x_0=y_1$$$$y_0=x_1-(a\ div\ b)y_1$$</p><p class="par">因此，当 $a,b\neq0$ 时，$x,y$ 的值可以递归求得。递归边界为：$b=0$ 时 $x=1,y=0$。</p><p>注意到上面的算法用到了一个技巧：在递归传参数的时候将 y, x 调换了。这样做的好处是节省了一个中间变量用来储存 $y_1$，否则在计算 $y_0$ 时 $y_1$ 也被覆盖了。从而使算法更加的精简。</p><h2 id="应用"><strong>应用</strong></h2><ul><li>计算几何中求整点的问题</li><li>求一元一次同余方程 $a\equiv b\pmod{m}$ 的一组特解。（即方程 $ax+my=b$ 的一组特解）</li></ul></div><div lang="zh" class="post__readmore font__ui"><a href="/extended-gcd-algorithm/">READ MORE</a></div></article><article lang="zh" class="post"><div class="post__title-block"><h1 class="post__title"><a href="/uva10285-cake-slicing/">UVa10285 Cake Slicing</a></h1><span class="post__lang-tag font__ui">zh</span></div><div lang="zh" class="post__meta font__ui">2014-10-01 | <span class="post__meta-categories"><a href="/categories/Tech/">Tech</a></span></div><div data-post-id="873d44f7cc26cdf098f419b3fcaa9430099cfb2628a5f17fa6d5ccd404460384" class="post__content font__body"><blockquote><p class="noindent">链接：<a target="_blank" rel="noopener" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=825&page=show_problem&problem=4504">Link</a> 耗时：1.825s</p></blockquote><p>这道题做的可真够久的：前前后后加起来将近有两个小时，因此当 AC 的那一刻，自己心中还是挺自豪的。</p><p>事实上，这是一道复杂一点的区间型动态规划，之所以说“复杂”，是因为它的状态转移是<strong>二维</strong>的：切蛋糕既可以横切，也可以纵切。由此我想到了分治算法：</p><blockquote><p class="noindent">假设一个矩形它所需要切的刀数是 f，则 f 可以由组成该矩形的小矩形的 f 值决定。</p></blockquote><p class="par">因此，这个问题具有最优子结构。由于每个状态为一个矩形，因此需要 4 个维度来记录状态（及左上、右下两个顶点）。下面是横切时的状态转移方程，纵切时同理可得：</p><p>$$ \begin{aligned} f(up, down, left, right) = &amp;\ min\{f(up, i, left, right) \\ &amp; + f(i, down, left, right) + right - left\},i = up + 1 .. down -1 \end{aligned} $$</p><div class="gk-code hljs" data-gk-id="BLOCK1"><div class="gk-code-display"><pre><span class="line"><span class="hljs-meta">{$R-}</span></span><br><span class="line"><span class="hljs-keyword">const</span> INF = maxint <span class="hljs-keyword">div</span> <span class="hljs-number">5</span>; <span class="hljs-comment">//正无穷</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    f: <span class="hljs-keyword">array</span> [<span class="hljs-number">0</span>..<span class="hljs-number">20</span>, <span class="hljs-number">0</span>..<span class="hljs-number">20</span>, <span class="hljs-number">0</span>..<span class="hljs-number">20</span>, <span class="hljs-number">0</span>..<span class="hljs-number">20</span>] <span class="hljs-keyword">of</span> integer;</span><br><span class="line">    cherries: <span class="hljs-keyword">array</span> [<span class="hljs-number">1</span>..<span class="hljs-number">500</span>, <span class="hljs-number">1</span>..<span class="hljs-number">2</span>] <span class="hljs-keyword">of</span> integer;</span><br><span class="line">    map: <span class="hljs-keyword">array</span> [<span class="hljs-number">0</span>..<span class="hljs-number">20</span>, <span class="hljs-number">0</span>..<span class="hljs-number">20</span>] <span class="hljs-keyword">of</span> boolean;</span><br><span class="line">    n, m, i, k: integer;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">min</span><span class="hljs-params">(x, y: integer)</span>:</span> integer; <span class="hljs-keyword">inline</span>;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> x&lt;y <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>(x) <span class="hljs-keyword">else</span> <span class="hljs-keyword">exit</span>(y);</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cherryin</span><span class="hljs-params">(u, d, l, r: integer)</span>:</span> integer; <span class="hljs-keyword">inline</span>; <span class="hljs-comment">//判断矩形内有没有樱桃</span></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    i, j: integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    cherryin := <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> i := u+<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> d <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">for</span> j := l+<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> r <span class="hljs-keyword">do</span></span><br><span class="line">            <span class="hljs-keyword">if</span> map[i, j] <span class="hljs-keyword">then</span></span><br><span class="line">            <span class="hljs-keyword">begin</span></span><br><span class="line">                inc(cherryin);</span><br><span class="line">                <span class="hljs-keyword">if</span> cherryin = <span class="hljs-number">2</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">exit</span>;</span><br><span class="line">            <span class="hljs-keyword">end</span>;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dp</span><span class="hljs-params">(u, d, l, r: integer)</span>:</span> integer;</span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    b: integer;</span><br><span class="line">    i: integer;</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> f[u, d, l, r] &lt;&gt; -<span class="hljs-number">1</span> <span class="hljs-keyword">then</span></span><br><span class="line">        <span class="hljs-keyword">exit</span>(f[u,d , l, r]);</span><br><span class="line">    b := cherryin(u, d, l, r);</span><br><span class="line">    <span class="hljs-keyword">if</span> b = <span class="hljs-number">1</span> <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        f[u, d, l, r] := <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> b = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        f[u, d, l, r] := INF;</span><br><span class="line">        <span class="hljs-keyword">exit</span>(INF);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    dp := INF;</span><br><span class="line">    <span class="hljs-keyword">for</span> i := u+<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> d-<span class="hljs-number">1</span> <span class="hljs-keyword">do</span></span><br><span class="line">        dp := min(dp, dp(u, i, l, r)+dp(i, d, l, r)+r-l);</span><br><span class="line">    <span class="hljs-keyword">for</span> i := l+<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> r-<span class="hljs-number">1</span> <span class="hljs-keyword">do</span></span><br><span class="line">        dp := min(dp, dp(u, d, l, i)+dp(u, d, i, r)+d-u);</span><br><span class="line">    f[u, d, l, r] := dp;</span><br><span class="line"><span class="hljs-keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span></span><br><span class="line">    _: integer;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    assign(input, <span class="hljs-string">&#x27;main.in&#x27;</span>);reset(input);</span><br><span class="line">    assign(output, <span class="hljs-string">&#x27;main.out&#x27;</span>);rewrite(output);</span><br><span class="line">    _ := <span class="hljs-number">0</span>;</span><br><span class="line">    readln(n, m, k);</span><br><span class="line">    <span class="hljs-keyword">while</span> n&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        inc(_);</span><br><span class="line">        fillchar(map, sizeof(map), <span class="hljs-number">0</span>);</span><br><span class="line">        fillchar(f, sizeof(f), -<span class="hljs-number">1</span>);</span><br><span class="line">        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> k <span class="hljs-keyword">do</span></span><br><span class="line">        <span class="hljs-keyword">begin</span></span><br><span class="line">            readln(cherries[i, <span class="hljs-number">1</span>], cherries[i, <span class="hljs-number">2</span>]);</span><br><span class="line">            map[cherries[i, <span class="hljs-number">1</span>], cherries[i, <span class="hljs-number">2</span>]] := true;</span><br><span class="line">        <span class="hljs-keyword">end</span>;</span><br><span class="line">        writeln(<span class="hljs-string">&#x27;Case &#x27;</span>,_,<span class="hljs-string">&#x27;: &#x27;</span>, dp(<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,m));</span><br><span class="line">        readln(n, m, k);</span><br><span class="line">    <span class="hljs-keyword">end</span>;</span><br><span class="line">    close(input);close(output);</span><br><span class="line"><span class="hljs-keyword">end</span>.</span><br></pre></div></div></div><div lang="zh" class="post__readmore font__ui"><a href="/uva10285-cake-slicing/">READ MORE</a></div></article></div><div lang="zh" class="page-navigator font__ui"><span class="page__button"><a href="/page/12/" class="pre">PREV</a></span><span class="page__button"><a href="/page/14/" class="next">NEXT</a></span></div></main><section class="aside__group"><span class="aside__btn"><div lang="zh" class="github-btn"><a href="#" rel="noopener noreferrer" target="_blank" class="gh-btn"><span class="gh-ico"></span><span class="gh-text">FOLLOW ME</span></a><a href="#" rel="noopener noreferrer" target="_blank" class="gh-count"></a></div><script>window.GH_BUTTON={username:"hsfzxjy"}</script></span><aside class="aside__left"><div class="aside__menuList"><span class="aside__menuList-item__icon current"><i class="icon-home"></i></span><a href="/" class="aside__menuList-item current"><span lang="zh" class="font__ui">首页 / Home</span></a><span class="aside__menuList-item__icon"><i class="icon-embed2"></i></span><a href="/categories/Tech/" class="aside__menuList-item"><span lang="zh" class="font__ui">科技 / Tech</span></a><span class="aside__menuList-item__icon"><i class="icon-android"></i></span><a href="/categories/Soliloquy/" class="aside__menuList-item"><span lang="zh" class="font__ui">呓语 / Soliloquy</span></a><span class="aside__menuList-item__icon"><i class="icon-leaf"></i></span><a href="/categories/Life/" class="aside__menuList-item"><span lang="zh" class="font__ui">生活 / Life</span></a><span class="aside__menuList-item__icon"><i class="icon-bookmarks"></i></span><a href="/categories/Memo/" class="aside__menuList-item"><span lang="zh" class="font__ui">速记 / Memo</span></a><span class="aside__menuList-item__icon"><i class="icon-books"></i></span><a href="/categories/Series/" class="aside__menuList-item"><span lang="zh" class="font__ui">连载 / Series</span></a><span class="aside__menuList-item__icon"><i class="icon-sigma"></i></span><a href="/works/" class="aside__menuList-item"><span lang="zh" class="font__ui">项目 / Projects</span></a><span class="aside__menuList-item__icon"><i class="icon-earth"></i></span><a href="/links/" class="aside__menuList-item"><span lang="zh" class="font__ui">友链 / Links</span></a><span class="aside__menuList-item__icon"><i class="icon-wink"></i></span><a href="/about/" class="aside__menuList-item"><span lang="zh" class="font__ui">关于 / About</span></a><span class="aside__menuList-item__icon"><i class="icon-history"></i></span><a href="/aggr/" class="aside__menuList-item"><span lang="zh" class="font__ui">索引 / Index</span></a><span class="aside__menuList-item__icon"><i class="icon-rss2"></i></span><a href="/rss.xml" class="aside__menuList-item"><span lang="zh" class="font__ui">订阅 / RSS</span></a></div></aside><aside class="aside__right"></aside></section><div id="footer" style="text-align:center" lang="zh" class="font__ui">© <a href="/" rel="nofollow">hsfzxjy 的博客.</a>&nbsp;Powered by&nbsp;<a rel="nofollow" target="_blank" href="https://hexo.io">Hexo.</a>&nbsp;<a rel="nofollow" target="_blank" href="https://github.com/hsfzxjy/byak-hexo">Theme</a>&nbsp;by&nbsp;<a rel="nofollow" target="_blank" href="https://github.com/hsfzxjy">hsfzxjy</a>.<div style="margin-top:10px"><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011202001249" style="display:inline-block;text-decoration:none;height:20px;line-height:20px"><img src="/img/beian.png" style="float:left" loading="lazy"><span style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#939393">粤公网安备44011202001249号</span></a><a target="_blank" style="display:inline-block;text-decoration:none;height:20px;line-height:20px" href="http://beian.miit.gov.cn/"><span style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#939393">粤ICP备2020075702号-1</span></a></div></div></body><script src="/dist/js/main.js" async defer></script></html>